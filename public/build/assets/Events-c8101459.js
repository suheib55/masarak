import{Q as _,p as R,r as u,o,b as S,w as F,d as e,c as a,f as c,g as C,F as j,e as i,v as p,t as d,N as k,i as U}from"./app-2594936b.js";import{_ as $}from"./MainLayout-a8c934ef.js";const D={class:"p-6 max-w-5xl mx-auto"},M={key:0,class:"mb-6 flex gap-4 justify-center"},z={class:"grid gap-6 md:grid-cols-2"},B=["src"],P={class:"p-5 flex flex-col flex-grow"},T={class:"text-xl font-semibold text-purple-700 mb-2"},W={class:"text-gray-600 mb-1"},O={class:"text-gray-600 mb-1"},Q={class:"text-gray-700 mb-2"},Y={class:"mt-2 pt-2 border-t border-gray-100 text-sm text-gray-500"},q=["onClick"],G={key:1,class:"text-center text-gray-500 mt-10"},H={key:2,class:"mt-12 max-w-2xl mx-auto"},J={class:"space-y-4"},K={class:"flex items-center gap-3 max-w-[85%]"},X=["href"],Z={class:"text-sm text-gray-400"},ee={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50"},te={class:"bg-white rounded-lg p-6 w-full max-w-md"},le={class:"flex justify-end gap-2"},ne={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50"},se={class:"bg-white rounded-lg p-6 w-full max-w-md"},oe={class:"flex justify-end gap-2"},ae={key:5,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50"},re={class:"bg-white rounded-lg p-6 w-full max-w-md"},ue={class:"text-xl font-bold text-green-700 mb-4 text-center"},de={class:"flex justify-end gap-2"},ve={__name:"Events",setup(ie){const v=_().props.user,f=R(()=>v?v.email==="smhmwdabwalshykh@gmail.com"?"admin":v.email.endsWith("@just.edu.jo")?"instructor":v.email.endsWith("@cit.just.edu.jo")?"student":"guest":"guest"),E=u(_().props.events||[]),y=u(_().props.announcedLinks||[]),m=u(!1),g=u(!1),x=u(!1),n=u({title:"",date:"",location:"",note:"",imagePreview:"",imageFile:null}),w=u(null),r=u({name:"",email:"",studentId:""}),b=u("");function V(s){const t=s.target.files[0];t&&(n.value.imagePreview=URL.createObjectURL(t),n.value.imageFile=t)}function A(){if(!n.value.title||!n.value.date)return;const s=new FormData;s.append("title",n.value.title),s.append("date",n.value.date),s.append("location",n.value.location),s.append("note",n.value.note),n.value.imageFile&&s.append("image",n.value.imageFile),k.post("/events",s,{preserveScroll:!0,onSuccess:()=>{m.value=!1,n.value={title:"",date:"",location:"",note:"",imagePreview:"",imageFile:null}},onError:()=>{alert("Error adding event")}})}function I(s){s.trim()!==""&&k.post("/announce-link",{link:s},{preserveScroll:!0,onSuccess:()=>{y.value.push(s),b.value="",g.value=!1},onError:()=>{alert("Error announcing link")}})}function L(s){w.value=s,x.value=!0,r.value={name:"",email:"",studentId:""}}function N(){k.post("/event-register",{event_id:w.value.id,name:r.value.name,email:r.value.email,student_id:r.value.studentId},{preserveScroll:!0,onSuccess:()=>{x.value=!1,alert("Registration successful!")},onError:()=>{alert("Error registering for event")}})}return(s,t)=>(o(),S($,null,{default:F(()=>[e("div",D,[t[20]||(t[20]=e("h1",{class:"text-3xl font-bold text-purple-800 mb-6 text-center"},"Events",-1)),f.value==="admin"||f.value==="instructor"?(o(),a("div",M,[e("button",{onClick:t[0]||(t[0]=l=>m.value=!0),class:"bg-purple-700 text-white px-4 py-2 rounded hover:bg-purple-600"}," Add Event "),e("button",{onClick:t[1]||(t[1]=l=>g.value=!0),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-500"}," Announce Event ")])):c("",!0),e("div",z,[(o(!0),a(j,null,C(E.value,l=>(o(),a("div",{key:l.id,class:"bg-white border border-gray-200 rounded-lg shadow hover:shadow-md transition overflow-hidden flex flex-col"},[e("img",{src:l.image_url||"https://data.textstudio.com/output/sample/animated/6/3/2/5/event-3-5236.gif",alt:"Event Image",class:"w-full h-48 object-cover"},null,8,B),e("div",P,[e("h2",T,d(l.title),1),e("p",W,[t[14]||(t[14]=e("strong",null,"Date:",-1)),U(" "+d(l.date),1)]),e("p",O,[t[15]||(t[15]=e("strong",null,"Location:",-1)),U(" "+d(l.location),1)]),e("p",Q,d(l.note),1),e("div",Y,[e("p",null,"Added by: "+d(l.created_by_name),1),e("p",null,d(l.created_by_email),1)]),f.value==="student"?(o(),a("button",{key:0,onClick:h=>L(l),class:"mt-4 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-500 transition w-full"}," Register ",8,q)):c("",!0)])]))),128))]),E.value.length?c("",!0):(o(),a("div",G,"No events yet.")),y.value.length?(o(),a("div",H,[t[17]||(t[17]=e("h2",{class:"text-2xl font-bold text-blue-900 mb-6 text-center"},"Announced Links",-1)),e("div",J,[(o(!0),a(j,null,C(y.value,(l,h)=>(o(),a("div",{key:h,class:"flex items-center justify-between bg-white border border-gray-200 shadow-sm hover:shadow-md transition p-4 rounded-lg"},[e("div",K,[t[16]||(t[16]=e("svg",{class:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M12.293 7.293a1 1 0 011.414 1.414l-3.586 3.586a1 1 0 01-1.414-1.414l3.586-3.586z"}),e("path",{d:"M7.293 12.707a1 1 0 01-1.414-1.414l3.586-3.586a1 1 0 011.414 1.414l-3.586 3.586z"})],-1)),e("a",{href:l,target:"_blank",class:"text-blue-700 font-medium hover:underline truncate"},d(l),9,X)]),e("span",Z,"#"+d(h+1),1)]))),128))])])):c("",!0),m.value?(o(),a("div",ee,[e("div",te,[t[18]||(t[18]=e("h2",{class:"text-xl font-bold text-purple-700 mb-4 text-center"},"Add New Event",-1)),i(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>n.value.title=l),placeholder:"Title",class:"w-full mb-3 px-4 py-2 border rounded"},null,512),[[p,n.value.title]]),i(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>n.value.date=l),type:"date",placeholder:"Date",class:"w-full mb-3 px-4 py-2 border rounded"},null,512),[[p,n.value.date]]),i(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>n.value.location=l),placeholder:"Location",class:"w-full mb-3 px-4 py-2 border rounded"},null,512),[[p,n.value.location]]),e("input",{type:"file",accept:"image/*",onChange:V,class:"w-full mb-3 px-4 py-2 border rounded"},null,32),i(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=l=>n.value.note=l),placeholder:"Note",class:"w-full mb-3 px-4 py-2 border rounded"},null,512),[[p,n.value.note]]),e("div",le,[e("button",{onClick:t[6]||(t[6]=l=>m.value=!1),class:"px-4 py-2 bg-gray-300 rounded"},"Cancel"),e("button",{onClick:A,class:"px-4 py-2 bg-purple-700 text-white rounded"},"Save Event")])])])):c("",!0),g.value?(o(),a("div",ne,[e("div",se,[t[19]||(t[19]=e("h2",{class:"text-xl font-bold text-blue-700 mb-4 text-center"},"Announce Event",-1)),i(e("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=l=>b.value=l),placeholder:"Paste event link...",class:"w-full mb-4 px-4 py-2 border rounded"},null,512),[[p,b.value]]),e("div",oe,[e("button",{onClick:t[8]||(t[8]=l=>g.value=!1),class:"px-4 py-2 bg-gray-300 rounded"},"Cancel"),e("button",{onClick:t[9]||(t[9]=l=>I(b.value)),class:"px-4 py-2 bg-blue-600 text-white rounded"},"Announce")])])])):c("",!0),x.value?(o(),a("div",ae,[e("div",re,[e("h2",ue," Register for "+d(w.value.title),1),i(e("input",{"onUpdate:modelValue":t[10]||(t[10]=l=>r.value.name=l),placeholder:"Your Name",class:"w-full mb-3 px-4 py-2 border rounded"},null,512),[[p,r.value.name]]),i(e("input",{"onUpdate:modelValue":t[11]||(t[11]=l=>r.value.email=l),placeholder:"University Email",class:"w-full mb-3 px-4 py-2 border rounded"},null,512),[[p,r.value.email]]),i(e("input",{"onUpdate:modelValue":t[12]||(t[12]=l=>r.value.studentId=l),placeholder:"Student ID",class:"w-full mb-4 px-4 py-2 border rounded"},null,512),[[p,r.value.studentId]]),e("div",de,[e("button",{onClick:t[13]||(t[13]=l=>x.value=!1),class:"px-4 py-2 bg-gray-300 rounded"},"Cancel"),e("button",{onClick:N,class:"px-4 py-2 bg-green-600 text-white rounded"},"Register")])])])):c("",!0)])]),_:1}))}};export{ve as default};
