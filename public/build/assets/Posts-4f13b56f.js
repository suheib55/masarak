import{Q as z,p as A,r as b,T as j,o as l,b as L,w as H,d as e,t as i,c as r,e as g,v as x,u as d,f as v,F as N,g as P,i as M,N as V}from"./app-6ead19b6.js";import{_ as Q}from"./MainLayout-70b4c895.js";const q={class:"p-6 max-w-2xl mx-auto"},G={class:"w-full flex justify-between items-center mb-6"},J={key:0,class:"bg-white border rounded-lg p-6 mb-8 shadow-md"},K={key:1,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-8 shadow-md"},O={key:2,class:"space-y-6"},R={class:"flex items-center mb-4"},X=["src"],Y={class:"font-semibold text-gray-800"},Z={class:"text-sm text-gray-500"},I={class:"text-xl font-bold text-gray-800 mb-3"},ee={class:"text-gray-700 mb-4 whitespace-pre-line"},te={key:0,class:"flex gap-3 mb-4"},se=["onClick"],oe=["onClick"],le={class:"border-t pt-4"},ne=["onClick"],re={class:"text-sm bg-gray-200 px-2 py-1 rounded-full ml-1"},ie={key:0},ae={key:0,class:"space-y-3 mb-4"},de=["src"],ue={class:"bg-gray-50 p-3 rounded-lg flex-1"},ce={class:"flex justify-between items-start"},me={class:"font-semibold text-sm text-gray-800"},pe={class:"text-xs text-gray-500"},ge={class:"text-gray-700 text-sm mt-1"},xe={key:1,class:"text-gray-500 text-sm italic mb-4"},fe={class:"flex gap-2"},he=["onUpdate:modelValue"],be=["onClick"],ve={key:3,class:"text-center py-12 text-gray-500"},we={__name:"Posts",props:{posts:Array,auth_user_id:Number},setup(_){const f=z().props.auth.user,D=A(()=>f?f.email==="smhmwdabwalshykh@gmail.com"?"admin":f.email.endsWith("@just.edu.jo")?"instructor":f.email.endsWith("@cit.just.edu.jo")?"student":"guest":"guest"),p=b(!1),u=b(null),c=b([]),h=b({}),m=j({title:"",content:""});function E(){m.post(route("posts.store"),{preserveScroll:!0,onSuccess:()=>{m.reset(),p.value=!1}})}function U(o){confirm("Are you sure you want to delete this post?")&&V.delete(route("posts.destroy",o),{preserveScroll:!0})}const a=j({title:"",content:""});function $(o){u.value=o,a.title=o.title,a.content=o.content}function B(){u.value&&a.put(route("posts.update",u.value.id),{preserveScroll:!0,onSuccess:()=>{u.value=null}})}function F(){u.value=null,a.reset()}function W(o){c.value.includes(o)?c.value=c.value.filter(s=>s!==o):c.value.push(o)}function T(o){const s=h.value[o];s&&V.post(route("posts.comment",o),{content:s},{preserveScroll:!0,onSuccess:()=>{h.value[o]=""}})}function y(o){return new Date(o).toLocaleDateString()}return(o,s)=>(l(),L(Q,null,{default:H(()=>[e("div",q,[e("div",G,[s[5]||(s[5]=e("h1",{class:"text-3xl font-bold text-purple-800"},"Community Feed",-1)),e("button",{onClick:s[0]||(s[0]=t=>p.value=!p.value),class:"bg-green-600 text-white font-semibold px-6 py-2 rounded-lg hover:bg-green-500 transition-colors"},i(p.value?"Cancel":"+ New Post"),1)]),p.value?(l(),r("div",J,[s[6]||(s[6]=e("h2",{class:"text-xl font-semibold text-gray-800 mb-4"},"Create New Post",-1)),g(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>d(m).title=t),type:"text",placeholder:"Post title",class:"w-full mb-4 px-4 py-2 border rounded-lg"},null,512),[[x,d(m).title]]),g(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=t=>d(m).content=t),rows:"4",placeholder:"What's on your mind?",class:"w-full mb-4 px-4 py-2 border rounded-lg resize-none"},null,512),[[x,d(m).content]]),e("div",{class:"flex justify-end"},[e("button",{onClick:E,class:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors"}," Post ")])])):v("",!0),u.value?(l(),r("div",K,[s[7]||(s[7]=e("h2",{class:"text-xl font-semibold text-gray-800 mb-4"},"Edit Post",-1)),g(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>d(a).title=t),type:"text",placeholder:"Post title",class:"w-full mb-4 px-4 py-2 border rounded-lg"},null,512),[[x,d(a).title]]),g(e("textarea",{"onUpdate:modelValue":s[4]||(s[4]=t=>d(a).content=t),rows:"4",placeholder:"Content",class:"w-full mb-4 px-4 py-2 border rounded-lg resize-none"},null,512),[[x,d(a).content]]),e("div",{class:"flex justify-end gap-3"},[e("button",{onClick:F,class:"bg-gray-400 text-white px-4 py-2 rounded-lg hover:bg-gray-500"}," Cancel "),e("button",{onClick:B,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"}," Save Changes ")])])):v("",!0),_.posts.length?(l(),r("div",O,[(l(!0),r(N,null,P(_.posts,t=>{var w,k;return l(),r("div",{key:t.id,class:"bg-white border rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow"},[e("div",R,[e("img",{src:(w=t.user)!=null&&w.profile_image?"/storage/"+t.user.profile_image:"/images/default-profile.png",class:"w-10 h-10 rounded-full mr-3 object-cover"},null,8,X),e("div",null,[e("p",Y,i((k=t.user)==null?void 0:k.name),1),e("p",Z,i(y(t.created_at)),1)])]),e("h2",I,i(t.title),1),e("p",ee,i(t.content),1),t.user_id===_.auth_user_id||D.value==="admin"?(l(),r("div",te,[e("button",{onClick:n=>$(t),class:"text-blue-600 hover:text-blue-800 transition-colors flex items-center gap-1"}," Edit ",8,se),e("button",{onClick:n=>U(t.id),class:"text-red-600 hover:text-red-800 transition-colors flex items-center gap-1"}," Delete ",8,oe)])):v("",!0),e("div",le,[e("button",{onClick:n=>W(t.id),class:"text-purple-600 hover:text-purple-800 flex items-center gap-1 mb-3"},[M(i(c.value.includes(t.id)?"Hide Comments":"Show Comments")+" ",1),e("span",re,i(t.comments.length),1)],8,ne),c.value.includes(t.id)?(l(),r("div",ie,[t.comments.length?(l(),r("div",ae,[(l(!0),r(N,null,P(t.comments,n=>{var C,S;return l(),r("div",{key:n.id,class:"flex items-start gap-3"},[e("img",{src:(C=n.user)!=null&&C.profile_image?"/storage/"+n.user.profile_image:"/images/default-profile.png",class:"w-8 h-8 rounded-full mt-1 object-cover"},null,8,de),e("div",ue,[e("div",ce,[e("p",me,i((S=n.user)==null?void 0:S.name),1),e("p",pe,i(y(n.created_at)),1)]),e("p",ge,i(n.content),1)])])}),128))])):(l(),r("div",xe,"No comments yet.")),e("div",fe,[g(e("input",{"onUpdate:modelValue":n=>h.value[t.id]=n,type:"text",placeholder:"Write a comment...",class:"flex-1 border px-4 py-2 rounded-lg"},null,8,he),[[x,h.value[t.id]]]),e("button",{onClick:n=>T(t.id),class:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700"}," Send ",8,be)])])):v("",!0)])])}),128))])):(l(),r("div",ve," No posts yet. Be the first to post! "))])]),_:1}))}};export{we as default};
