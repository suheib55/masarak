import{Q as N,r as i,p as V,o as a,b as T,w as A,d as l,e as c,v as M,m as S,c as s,g as b,F as f,t as r,f as y,N as D,i as G}from"./app-bb8a80f1.js";import{_ as O}from"./MainLayout-362ab268.js";const Q={class:"p-6 max-w-5xl mx-auto space-y-8"},R={class:"bg-white border rounded-lg p-6 shadow"},H={class:"grid gap-4 md:grid-cols-2 mb-4"},z=["value"],K=["value"],X={class:"flex justify-between items-center"},Y={key:0},Z={key:0,class:"grid md:grid-cols-2 gap-6 mt-6"},ee={class:"flex justify-between items-center"},te={class:"text-purple-800 font-bold text-lg"},le=["onClick"],oe={class:"flex flex-wrap gap-2"},ae={class:"bg-purple-100 text-purple-700 text-xs font-semibold px-2 py-1 rounded"},se={class:"bg-blue-100 text-blue-700 text-xs font-semibold px-2 py-1 rounded"},re={class:"text-gray-500 text-xs ml-auto"},ne={class:"text-sm text-gray-600"},ue={class:"font-semibold text-gray-800"},de={key:0,class:"text-gray-700 text-sm"},ie=["src"],pe=["href"],ce=["href"],ve={key:1,class:"text-center text-gray-500 mt-6"},fe={key:1,class:"bg-white border rounded-lg p-6 shadow"},me={class:"grid gap-4 md:grid-cols-2 mb-4"},ge=["value"],xe=["value"],be=["disabled"],_e={__name:"Materials",props:["materials","filters"],setup(ye){const j=N(),m=i(j.props.materials||[]),I=i(j.props.auth_user_id),U=j.props.filters||JSON.parse(localStorage.getItem("materialSearch"))||{},h=N().props.auth.user,P=V(()=>h?h.email==="smhmwdabwalshykh@gmail.com"?"admin":h.email.endsWith("@just.edu.jo")?"instructor":h.email.endsWith("@cit.just.edu.jo")?"student":"guest":"guest"),F={"كلية الطب":["دكتور في الطب","الصحة العامة","الإدارة والسياسات الصحية"],"كلية العلوم الطبية التطبيقية":["الإسعافات الأولية والطوارئ","تكنولوجيا الأشعة","العلوم الطبية المخبرية","تكنولوجيا صناعة الأسنان","علوم طب الأسنان والمساندة","البصريات","العلاج الطبيعي","العلاج الوظيفي","السمع والنطق","علوم التأهيل السريري","علاج الأسنان","تكنولوجيا التخدير"],"كلية الهندسة":["الهندسة الكيميائية","الهندسة المدنية","الهندسة الكهربائية","الهندسة الميكانيكية","الهندسة الطبية الحيوية","الهندسة الصناعية","هندسة الطيران","تكنولوجيا صيانة الطائرات","دبلوماسية المياه","الهندسة النووية"],"كلية الصيدلة":["الصيدلة","دكتور صيدلة","التصنيع الدوائي والبيولوجي"],"كلية التمريض":["التمريض"],"كلية طب الأسنان":["طب وجراحة الأسنان"],"كلية تكنولوجيا معلومات الحاسوب":["هندسة الحاسوب","علوم الحاسوب","نظم المعلومات الحاسوبية","هندسة وأمن شبكات الحاسوب","هندسة البرمجيات","الأمن السيبراني","علم البيانات","الذكاء الاصطناعي","إنترنت الأشياء","تصميم وتطوير ألعاب الحاسوب"],"الطب البيطري":["دكتور في الطب البيطري"],"كلية الزراعة":["الإنتاج الحيواني","الإنتاج النباتي","التغذية وتكنولوجيا الغذاء","الموارد الطبيعية والبيئية"],"شعبة العلوم العسكرية":["علوم عسكرية"],"كلية العلوم والآداب":["اللغة العربية","اللغة الإنجليزية واللغويات","الرياضيات","الكيمياء","الفيزياء","العلوم الحياتية التطبيقية","التقانات الحيوية والهندسة"],"مركز اللغات":["مركز اللغات"],"كلية العمارة والتصميم":["التخطيط والدراسات الحضرية","العمارة","تخطيط وتصميم المدن","التصميم والتواصل البصري","هندسة التخطيط الحضري والبيئي"],"معهد النانوتكنولوجي":["هندسة وعلوم النانو","علوم المياه والطاقة والغذاء"]},n=i(U.college||""),d=i(U.major||""),v=i(U.query||""),w=i(!1),u=i(!1),g=i(""),_=i(""),k=i(null),x=i(!1),C=V(()=>F[n.value]||[]);function $(o){return new Date(o).toLocaleDateString()}function B(o){const t=o.target.files[0];t&&["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","image/png","image/jpeg"].includes(t.type)?k.value=t:alert("Allowed file types: PDF, Word, PowerPoint, JPG, PNG")}function E(o){return o.includes("pdf")?"📄":o.includes("word")?"📝":o.includes("powerpoint")?"📊":o.includes("image")?"🖼️":"📁"}function q(){if(!v.value&&!n.value&&!d.value){alert("Please enter a search query or select filters.");return}u.value=!0,localStorage.setItem("materialSearch",JSON.stringify({query:v.value,college:n.value,major:d.value})),D.get("/materials",{college:n.value,major:d.value,query:v.value},{preserveState:!0,replace:!0,onSuccess:o=>{m.value=o.props.materials||[],w.value=!0,u.value=!1},onError:()=>{u.value=!1}})}function W(){v.value="",n.value="",d.value="",w.value=!1,localStorage.removeItem("materialSearch")}function J(){if(n.value&&d.value&&k.value&&g.value){const o=new FormData;o.append("faculty",n.value),o.append("major",d.value),o.append("title",g.value),o.append("note",_.value),o.append("file",k.value),u.value=!0,D.post("/materials",o,{forceFormData:!0,onSuccess:()=>{u.value=!1,k.value=null,_.value="",g.value="",document.getElementById("fileInput").value="",n.value="",d.value="",x.value=!1,window.location.reload()},onError:()=>{u.value=!1,alert("Failed to upload. Check your input.")}})}else alert("Please complete all fields and upload a valid file.")}function L(o){confirm("Are you sure you want to delete this material?")&&(u.value=!0,D.delete(`/materials/${o}`,{onSuccess:()=>{u.value=!1,m.value=m.value.filter(t=>t.id!==o)},onError:()=>{u.value=!1,alert("Failed to delete material.")}}))}return(o,t)=>(a(),T(O,null,{default:A(()=>[l("div",Q,[l("div",R,[t[10]||(t[10]=l("h2",{class:"text-xl font-bold text-purple-800 mb-4"},"🔍 Search Materials",-1)),c(l("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>v.value=e),class:"w-full border px-4 py-2 rounded mb-4",placeholder:"e.g., physics, summary, final..."},null,512),[[M,v.value]]),l("div",H,[c(l("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.value=e),class:"w-full border px-4 py-2 rounded"},[t[8]||(t[8]=l("option",{value:""},"Select Faculty",-1)),(a(),s(f,null,b(F,(e,p)=>l("option",{key:p,value:p},r(p),9,z)),64))],512),[[S,n.value]]),c(l("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e),class:"w-full border px-4 py-2 rounded"},[t[9]||(t[9]=l("option",{value:""},"Select Major",-1)),(a(!0),s(f,null,b(C.value,e=>(a(),s("option",{key:e,value:e},r(e),9,K))),128))],512),[[S,d.value]])]),l("div",X,[l("button",{onClick:q,class:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-500"},r(u.value?"Searching...":"Search"),1),w.value?(a(),s("button",{key:0,onClick:W,class:"text-gray-600 hover:underline text-sm"}," Clear ")):y("",!0)])]),w.value?(a(),s("div",Y,[t[12]||(t[12]=l("h2",{class:"text-xl font-bold text-purple-800 text-center mt-6"},"📚 Search Results",-1)),m.value.length?(a(),s("div",Z,[(a(!0),s(f,null,b(m.value,e=>(a(),s("div",{key:e.id,class:"bg-white border rounded-lg shadow p-4 space-y-2"},[l("div",ee,[l("p",te,r(E(e.file_type))+" "+r(e.title||e.file_name),1),e.user_id===I.value||P.value==="admin"?(a(),s("button",{key:0,onClick:p=>L(e.id),class:"text-red-600 hover:underline text-sm"},"Delete",8,le)):y("",!0)]),l("div",oe,[l("span",ae,r(e.faculty),1),l("span",se,r(e.major),1),l("span",re,"📅 "+r($(e.created_at)),1)]),l("p",ne,[t[11]||(t[11]=G(" 👤 Uploaded by: ")),l("span",ue,r(e.user_name),1)]),e.note?(a(),s("p",de,"📝 "+r(e.note),1)):y("",!0),l("div",null,[e.file_type.startsWith("image/")?(a(),s(f,{key:0},[l("img",{src:`/storage/${e.file_path}`,alt:"Material image",class:"w-full max-h-64 object-contain rounded border mb-2"},null,8,ie),l("a",{href:`/storage/${e.file_path}`,download:"",class:"text-blue-600 hover:underline text-sm"},"📥 Download image",8,pe)],64)):(a(),s("a",{key:1,href:`/storage/${e.file_path}`,download:"",class:"text-blue-600 hover:underline text-sm"},"📥 Download file",8,ce))])]))),128))])):(a(),s("div",ve," No materials found. "))])):y("",!0),l("div",null,[l("button",{onClick:t[3]||(t[3]=e=>x.value=!x.value),class:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-500"},r(x.value?"Hide Upload Form":"➕ Upload Material"),1)]),x.value?(a(),s("div",fe,[t[15]||(t[15]=l("h2",{class:"text-xl font-semibold text-purple-700 mb-4"},"⬆️ Upload Material",-1)),l("div",me,[c(l("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>n.value=e),class:"w-full border px-4 py-2 rounded"},[t[13]||(t[13]=l("option",{value:""},"Select Faculty",-1)),(a(),s(f,null,b(F,(e,p)=>l("option",{key:p,value:p},r(p),9,ge)),64))],512),[[S,n.value]]),c(l("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>d.value=e),class:"w-full border px-4 py-2 rounded"},[t[14]||(t[14]=l("option",{value:""},"Select Major",-1)),(a(!0),s(f,null,b(C.value,e=>(a(),s("option",{key:e,value:e},r(e),9,xe))),128))],512),[[S,d.value]])]),c(l("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=e=>g.value=e),class:"w-full border px-4 py-2 rounded mb-4",placeholder:"Material Title"},null,512),[[M,g.value]]),l("input",{type:"file",id:"fileInput",onChange:B,accept:".pdf,.doc,.docx,.ppt,.pptx,.png,.jpg,.jpeg",class:"w-full border px-4 py-2 rounded mb-4"},null,32),c(l("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>_.value=e),rows:"2",class:"w-full border px-4 py-2 rounded mb-4",placeholder:"Notes (optional)"},null,512),[[M,_.value]]),l("button",{onClick:J,class:"bg-purple-700 text-white px-6 py-2 rounded hover:bg-purple-600",disabled:u.value},r(u.value?"Uploading...":"Upload"),9,be)])):y("",!0)])]),_:1}))}};export{_e as default};
